<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Three-form verbs cloze test</title>
  <style>
    :root{
      --bg:#f6f8fb;
      --card:#fff;
      --accent:#1f6feb;
      --ok:#d4f7dc;
      --bad:#ffd6d6;
      --muted:#556;
      --border:#e1e6ee;
    }
    body{
      margin:0;
      font-family:Segoe UI, Roboto, "Helvetica Neue", Arial, sans-serif;
      background:linear-gradient(180deg,#f0f5ff 0%,var(--bg) 100%);
      color:#0b2545;
      padding:22px;
    }
    .wrap{ max-width:980px; margin:0 auto; }
    h1{ font-size:20px; margin:0 0 6px 0; }
    p.lead{ margin:0 0 14px 0; color:var(--muted); }
    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:10px;
      padding:14px;
      box-shadow:0 6px 18px rgba(15,40,80,0.05);
    }
    .row{
      display:grid;
      grid-template-columns: 1fr 210px;
      gap:12px;
      padding:12px 8px;
      border-bottom:1px dashed #eef2f7;
      align-items:start;
    }
    .row:last-child{ border-bottom:0; }
    .verb-title{ font-weight:700; margin-bottom:6px; }
    .sentence{ margin:6px 0; line-height:1.5; font-size:15px; }
    .inplace{ display:inline-block; vertical-align:middle; width:170px; }
    input[type="text"]{
      width:100%;
      padding:6px 8px;
      font-size:14px;
      border:1px solid var(--border);
      border-radius:6px;
      box-sizing:border-box;
    }
    .feedback{
      font-size:13px;
      margin-top:8px;
    }
    .field-ok{ background:var(--ok); border:1px solid #9fe7a9; }
    .field-bad{ background:var(--bad); border:1px solid #ff9a9a; }
    .correct-answer{
      display:inline-block;
      padding:4px 8px;
      border-radius:6px;
      background:rgba(13,90,35,0.06);
      color:#084b26;
      font-weight:700;
      font-size:13px;
      margin-left:6px;
    }
    footer{ margin-top:14px; color:var(--muted); font-size:13px; }
    @media (max-width:820px){
      .row{ grid-template-columns: 1fr; }
      .inplace{ width:140px; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Three-form verbs cloze test</h1>
    <p class="lead">Type the correct verb form into each blank. Past simple forms go in the first sentence, past participles (present perfect) in the second sentence. Feedback appears automatically when you leave a field or press Enter.</p>

    <div class="card" id="quiz"></div>

    <footer>Verbs: be, begin, break, come, do, eat, go, have, know, leave, read, see, take, write, find.</footer>
  </div>

  <script>
    // Provided items (exact sentences you supplied)
    const items = [
      {base:"be", pastSentence:"Yesterday he ______ at home all day.", perfSentence:"She has just ______ to the shop."},
      {base:"begin", pastSentence:"The meeting ______ at nine yesterday.", perfSentence:"They have already ______ their breakfast."},
      {base:"break", pastSentence:"He ______ his phone last week.", perfSentence:"I have recently ______ my glasses."},
      {base:"come", pastSentence:"She ______ back late last night.", perfSentence:"We have just ______ back to London."},
      {base:"do", pastSentence:"He ______ his homework before dinner.", perfSentence:"I have already ______ that task."},
      {base:"eat", pastSentence:"Franek ______ all the biscuits before Janek had a chance to have one.", perfSentence:"Franek's Dad has just ______ sushi, and is still hungry."},
      {base:"go", pastSentence:"I ______ to a birthday party instead of having an English lesson with Daniel.", perfSentence:"Jan is not here, he has already ______ to the gym."},
      {base:"have", pastSentence:"Franek ______ a good time at the party.", perfSentence:"We have only ______ three meetings so far."},
      {base:"know", pastSentence:"Yesterday, he ______ the answer, but now has forgotten it.", perfSentence:"I have always ______ how to speak Polish."},
      {base:"leave", pastSentence:"They ______ for the station at six in the morning.", perfSentence:"Gosia has already ______ the office."},
      {base:"read", pastSentence:"I ______ that novel last month.", perfSentence:"He has just ______ the article."},
      {base:"see", pastSentence:"We ______ the film on Netflix last Friday.", perfSentence:"I have never ______ that film before."},
      {base:"take", pastSentence:"Yesterday, she ______ a photo of a cat punching a dog.", perfSentence:"They have already ______ several photographs of the rubbish bin."},
      {base:"write", pastSentence:"He ______ the letter last week.", perfSentence:"I have already ______ three emails today."},
      {base:"find", pastSentence:"She ______ a small coin in the middle of the busy street.", perfSentence:"We have finally ______ the answer to why schoolchildren are so loud."}
    ];

    // Correct forms mapping (British English)
    const correctMap = {
      "be": {past:["was","were"], part:["been"]},
      "begin": {past:["began"], part:["begun"]},
      "break": {past:["broke"], part:["broken"]},
      "come": {past:["came"], part:["come"]},
      "do": {past:["did"], part:["done"]},
      "eat": {past:["ate"], part:["eaten"]},
      "go": {past:["went"], part:["gone"]},
      "have": {past:["had"], part:["had"]},
      "know": {past:["knew"], part:["known"]},
      "leave": {past:["left"], part:["left"]},
      "read": {past:["read"], part:["read"]},
      "see": {past:["saw"], part:["seen"]},
      "take": {past:["took"], part:["taken"]},
      "write": {past:["wrote"], part:["written"]},
      "find": {past:["found"], part:["found"]}
    };

    const quiz = document.getElementById('quiz');

    // Render rows
    items.forEach((it, idx) => {
      const row = document.createElement('div');
      row.className = 'row';
      row.id = `row-${idx}`;

      const left = document.createElement('div');
      left.innerHTML = `<div class="verb-title">${it.base}</div>
        <div class="sentence">Past simple: ${renderInputInSentence(it.pastSentence, `past-${idx}`)}</div>
        <div class="sentence">Present perfect: ${renderInputInSentence(it.perfSentence, `part-${idx}`)}</div>
        <div class="feedback" id="fb-${idx}" aria-live="polite"></div>`;

      const right = document.createElement('div');
      right.innerHTML = `<div style="text-align:right;color:var(--muted);font-size:13px;">Type the form and press Enter or leave the field to check.</div>`;

      row.appendChild(left);
      row.appendChild(right);
      quiz.appendChild(row);

      // Attach event listeners for automatic checking
      const pastEl = document.getElementById(`past-${idx}`);
      const partEl = document.getElementById(`part-${idx}`);

      let t1 = null, t2 = null;
      pastEl.addEventListener('input', ()=>{ clearTimeout(t1); t1 = setTimeout(()=>checkRow(idx), 500); });
      partEl.addEventListener('input', ()=>{ clearTimeout(t2); t2 = setTimeout(()=>checkRow(idx), 500); });

      pastEl.addEventListener('blur', ()=>checkRow(idx));
      partEl.addEventListener('blur', ()=>checkRow(idx));

      [pastEl, partEl].forEach(el=>{
        el.addEventListener('keydown', (e)=>{
          if (e.key === 'Enter'){
            e.preventDefault();
            checkRow(idx);
          }
        });
      });
    });

    // Replace blank with input element
    function renderInputInSentence(sentence, inputId){
      const input = `<span class="inplace"><input type="text" id="${inputId}" autocomplete="off" spellcheck="false" /></span>`;
      if (sentence.includes('______')) {
        // escape then replace underscores placeholder
        return escapeHtml(sentence).replace('______', input);
      } else {
        return escapeHtml(sentence) + ' ' + input;
      }
    }

    function normalize(s){ return String(s||'').trim().toLowerCase().replace(/\s+/g,' '); }
    function escapeHtml(s){
      return String(s)
        .replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;')
        .replace(/"/g,'&quot;').replace(/'/g,'&#39;');
    }

    // Check single row (both fields)
    function checkRow(idx){
      const it = items[idx];
      const base = it.base;
      const pastEl = document.getElementById(`past-${idx}`);
      const partEl = document.getElementById(`part-${idx}`);
      const fb = document.getElementById(`fb-${idx}`);

      const userPast = normalize(pastEl.value);
      const userPart = normalize(partEl.value);

      const okPast = correctMap[base].past.includes(userPast);
      const okPart = correctMap[base].part.includes(userPart);

      // Reset classes
      pastEl.classList.remove('field-ok','field-bad');
      partEl.classList.remove('field-ok','field-bad');

      if (userPast.length === 0 || !okPast) pastEl.classList.add('field-bad'); else pastEl.classList.add('field-ok');
      if (userPart.length === 0 || !okPart) partEl.classList.add('field-bad'); else partEl.classList.add('field-ok');

      // Build feedback
      if (okPast && okPart){
        fb.innerHTML = `<span style="color:#177a2f;font-weight:700">Both forms correct.</span>`;
      } else {
        let parts = [];
        if (!okPast){
          const expected = correctMap[base].past.join(' / ');
          parts.push(`Past simple: ${userPast?escapeHtml(userPast):'<em>(empty)</em>'} → correct: <span class="correct-answer">${escapeHtml(expected)}</span>`);
        } else {
          parts.push('Past simple: OK');
        }
        if (!okPart){
          const expectedP = correctMap[base].part.join(' / ');
          parts.push(`Present perfect: ${userPart?escapeHtml(userPart):'<em>(empty)</em>'} → correct: <span class="correct-answer">${escapeHtml(expectedP)}</span>`);
        } else {
          parts.push('Present perfect: OK');
        }
        fb.innerHTML = parts.join('<br>');
      }
    }
  </script>
</body>
</html>
