<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Three-form verbs test</title>
  <style>
    :root{
      --bg:#f6f8fb;
      --card:#ffffff;
      --accent:#1f6feb;
      --ok:#d4f7dc;
      --bad:#ffd6d6;
      --muted:#556;
      --border:#e1e6ee;
      --note:#0b2545;
    }
    body{
      margin:0;
      font-family:Segoe UI, Roboto, "Helvetica Neue", Arial, sans-serif;
      background:linear-gradient(180deg,#f0f5ff 0%,var(--bg) 100%);
      color:var(--note);
      padding:20px;
    }
    .wrap{ max-width:900px; margin:0 auto; }
    h1{ font-size:20px; margin:0 0 8px 0; }
    p.lead{ margin:0 0 14px 0; color:var(--muted); }
    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:10px;
      padding:14px;
      box-shadow:0 6px 18px rgba(15,40,80,0.05);
    }
    .verb{
      border-bottom:1px dashed #eef2f7;
      padding:12px 0;
      display:grid;
      grid-template-columns: 1fr 120px;
      gap:12px;
      align-items:start;
    }
    .verb:last-child{ border-bottom:0; }
    .sentences{ line-height:1.6; }
    .sentence{
      margin:8px 0;
      font-size:15px;
    }
    .inplace{
      display:inline-block;
      vertical-align:middle;
      width:160px;
    }
    input[type="text"]{
      width:100%;
      padding:6px 8px;
      font-size:14px;
      border:1px solid var(--border);
      border-radius:6px;
      box-sizing:border-box;
    }
    .controls{
      display:flex;
      gap:8px;
      align-items:center;
    }
    button{
      background:var(--accent);
      color:#fff;
      border:0;
      padding:8px 10px;
      border-radius:8px;
      cursor:pointer;
      font-weight:600;
    }
    .btn-secondary{
      background:#fff;
      color:var(--accent);
      border:1px solid var(--accent);
      box-shadow:none;
    }
    .result{
      margin-top:8px;
      font-size:14px;
      font-weight:700;
    }
    .field-ok{ background:var(--ok); border:1px solid #9fe7a9; }
    .field-bad{ background:var(--bad); border:1px solid #ff9a9a; }
    .correct-answer{
      display:inline-block;
      margin-left:10px;
      padding:4px 8px;
      border-radius:6px;
      background:rgba(13,90,35,0.06);
      color:#084b26;
      font-weight:700;
      font-size:13px;
    }
    footer{ margin-top:14px; color:var(--muted); font-size:13px; }
    @media (max-width:700px){
      .verb{ grid-template-columns: 1fr; }
      .inplace{ width:140px; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Three-form verbs test</h1>
    <p class="lead">Complete each sentence with the correct verb form. Each verb has two sentences: past simple and present perfect. Type only the verb form required in each blank and press the Submit button for that verb to check your answers immediately.</p>

    <div class="card" id="quiz"></div>

    <footer>Verbs tested: be, begin, break, come, do, eat, go, have, know, leave, read, see, take, write, find.</footer>
  </div>

  <script>
    // Verbs and two sentence templates (past simple; present perfect)
    // Sentences include a blank where an input will be placed.
    const items = [
      {base:"be", pastSentence:"Yesterday he ______ at home all day.", perfSentence:"She ______ to that school several times."},
      {base:"begin", pastSentence:"The meeting ______ at nine yesterday.", perfSentence:"They ______ the project this month."},
      {base:"break", pastSentence:"He ______ his phone last week.", perfSentence:"I ______ my glasses many times."},
      {base:"come", pastSentence:"She ______ back late last night.", perfSentence:"We ______ to London twice this year."},
      {base:"do", pastSentence:"He ______ his homework before dinner.", perfSentence:"I ______ that task already."},
      {base:"eat", pastSentence:"They ______ all the biscuits yesterday.", perfSentence:"She ______ sushi before."},
      {base:"go", pastSentence:"I ______ to the market on Saturday.", perfSentence:"He ______ to Spain several times."},
      {base:"have", pastSentence:"She ______ a good time at the party.", perfSentence:"We ______ three meetings so far."},
      {base:"know", pastSentence:"He ______ the answer yesterday.", perfSentence:"I ______ her for many years."},
      {base:"leave", pastSentence:"They ______ the station at six.", perfSentence:"She ______ the office already."},
      {base:"read", pastSentence:"I ______ that novel last month.", perfSentence:"He ______ that article already."},
      {base:"see", pastSentence:"We ______ the show on Friday.", perfSentence:"I ______ that film before."},
      {base:"take", pastSentence:"She ______ the photo yesterday.", perfSentence:"They ______ several photographs this year."},
      {base:"write", pastSentence:"He ______ the letter yesterday.", perfSentence:"I ______ three emails today."},
      {base:"find", pastSentence:"She ______ a small coin on the path.", perfSentence:"We ______ the answer at last."}
    ];

    // Allowed correct answers per verb: past simple (array), past participle (array)
    const correctMap = {
      "be": {past: ["was","were"], part: ["been"]},
      "begin": {past: ["began"], part: ["begun"]},
      "break": {past: ["broke"], part: ["broken"]},
      "come": {past: ["came"], part: ["come"]},
      "do": {past: ["did"], part: ["done"]},
      "eat": {past: ["ate"], part: ["eaten"]},
      "go": {past: ["went"], part: ["gone"]},
      "have": {past: ["had"], part: ["had"]},
      "know": {past: ["knew"], part: ["known"]},
      "leave": {past: ["left"], part: ["left"]},
      "read": {past: ["read"], part: ["read"]},
      "see": {past: ["saw"], part: ["seen"]},
      "take": {past: ["took"], part: ["taken"]},
      "write": {past: ["wrote"], part: ["written"]},
      "find": {past: ["found"], part: ["found"]}
    };

    // Build quiz HTML
    const quiz = document.getElementById('quiz');

    items.forEach((it, idx) => {
      const container = document.createElement('div');
      container.className = 'verb';
      container.id = `verb-${idx}`;

      // Create sentence elements with inputs inserted inline
      const pastInputId = `past-${idx}`;
      const partInputId = `part-${idx}`;

      const left = document.createElement('div');
      left.className = 'sentences';
      left.innerHTML = `
        <div class="sentence"><strong>${it.base}</strong></div>
        <div class="sentence">Past simple: ${renderSentenceWithInput(it.pastSentence, pastInputId)}</div>
        <div class="sentence">Present perfect: ${renderSentenceWithInput(it.perfSentence, partInputId)}</div>
        <div class="result" id="result-${idx}" aria-live="polite"></div>
      `;

      const right = document.createElement('div');
      right.className = 'controls';
      right.innerHTML = `
        <button type="button" id="check-${idx}">Submit</button>
        <button type="button" class="btn-secondary" id="reveal-${idx}">Show answer</button>
      `;

      container.appendChild(left);
      container.appendChild(right);
      quiz.appendChild(container);

      // attach events
      document.addEventListener('click', function(e){
        if (e.target && e.target.id === `check-${idx}`){
          checkOne(idx);
        } else if (e.target && e.target.id === `reveal-${idx}`){
          revealOne(idx);
        }
      });
    });

    // Helper: render sentence string but replace the first occurrence of "______" or "_____" with an input.
    function renderSentenceWithInput(sentence, inputId){
      // If sentence contains "______", replace it; otherwise append input at end separated by space.
      const blankMarkup = `<span class="inplace"><input type="text" id="${inputId}" autocomplete="off" spellcheck="false" /></span>`;
      if (sentence.indexOf('______') !== -1){
        return escapeHtml(sentence).replace('______', blankMarkup);
      } else {
        // place input where two underscores appear or create one at end
        return escapeHtml(sentence) + ' ' + blankMarkup;
      }
    }

    // Normalize input
    function normalize(s){
      return String(s || '').trim().toLowerCase().replace(/\s+/g,' ');
    }

    // Escape HTML
    function escapeHtml(s){
      return String(s)
        .replace(/&/g,'&amp;')
        .replace(/</g,'&lt;')
        .replace(/>/g,'&gt;')
        .replace(/"/g,'&quot;')
        .replace(/'/g,'&#39;');
    }

    // Check a single verb (both inputs); provides immediate feedback for that verb only
    function checkOne(idx){
      const it = items[idx];
      const base = it.base;
      const pastEl = document.getElementById(`past-${idx}`);
      const partEl = document.getElementById(`part-${idx}`);
      const resultEl = document.getElementById(`result-${idx}`);

      const userPast = normalize(pastEl.value);
      const userPart = normalize(partEl.value);

      const correctPast = correctMap[base].past.includes(userPast);
      const correctPart = correctMap[base].part.includes(userPart);

      // reset classes
      pastEl.classList.remove('field-ok','field-bad');
      partEl.classList.remove('field-ok','field-bad');

      if (userPast.length === 0 || !correctPast){
        pastEl.classList.add('field-bad');
      } else {
        pastEl.classList.add('field-ok');
      }
      if (userPart.length === 0 || !correctPart){
        partEl.classList.add('field-bad');
      } else {
        partEl.classList.add('field-ok');
      }

      // Build feedback
      let messages = [];
      if (correctPast && correctPart){
        messages.push('<span style="color:#177a2f">Both forms correct.</span>');
      } else {
        if (!correctPast){
          const expectedPast = correctMap[base].past.join(' / ');
          const shown = userPast ? escapeHtml(userPast) : '<em>(empty)</em>';
          messages.push(`Past simple: ${shown} → correct: <span class="correct-answer">${escapeHtml(expectedPast)}</span>`);
        } else {
          messages.push('Past simple: OK');
        }
        if (!correctPart){
          const expectedPart = correctMap[base].part.join(' / ');
          const shown = userPart ? escapeHtml(userPart) : '<em>(empty)</em>';
          messages.push(`Present perfect (past participle): ${shown} → correct: <span class="correct-answer">${escapeHtml(expectedPart)}</span>`);
        } else {
          messages.push('Present perfect (past participle): OK');
        }
      }

      resultEl.innerHTML = messages.join('<br>');
      // focus first bad input
      const firstBad = document.querySelector(`#verb-${idx} .field-bad`);
      if (firstBad) firstBad.focus();
    }

    // Reveal answers for a single verb (fills inputs and marks ok)
    function revealOne(idx){
      const it = items[idx];
      const base = it.base;
      const pastEl = document.getElementById(`past-${idx}`);
      const partEl = document.getElementById(`part-${idx}`);
      pastEl.value = correctMap[base].past.join(' / ');
      partEl.value = correctMap[base].part.join(' / ');
      pastEl.classList.remove('field-bad'); pastEl.classList.add('field-ok');
      partEl.classList.remove('field-bad'); partEl.classList.add('field-ok');
      document.getElementById(`result-${idx}`).innerHTML = '<span style="color:#177a2f;font-weight:700">Answers revealed</span>';
    }

    // Allow Enter to submit current verb when focus is inside one of its inputs
    document.addEventListener('keydown', function(e){
      if (e.key === 'Enter'){
        const active = document.activeElement;
        if (active && active.tagName === 'INPUT'){
          e.preventDefault();
          // find parent verb id
          let node = active;
          while (node && node.id && !node.id.startsWith('verb-')){
            node = node.parentElement;
          }
          // alternative: traverse up to .verb
          node = active.closest('.verb');
          if (node){
            const id = node.id.split('-')[1];
            if (id !== undefined) checkOne(Number(id));
          }
        }
      }
    });
  </script>
</body>
</html>
